import{z as h,a1 as N,d as y,y as I,A as U,c as V,B as k,l as f,C as B,D as e,f as t,u as s,v as C,Q as R,H as m,J as z,a8 as E,L,R as M,n as q,F as A,a6 as D,T as F,a7 as J}from"./index-DrptD63I.js";import{E as P}from"./index-CsCBwo62.js";import{T as j}from"./index-BTNqQ4Af.js";function H(){const{endpoint:l}=h(),a=new URL(N(l,"api/ruleStatistic"),location.href);return fetch(a).then(o=>o.json())}const Q={class:"search-box"},$=y({__name:"ruleMetricsTable",setup(l){const a=I(),o=h(),{data:c,refresh:r,loading:p}=U(H,{pollingInterval:V(()=>a.pollingInterval),onSuccess:a.renewLastUpdate}),g=[{title:"规则类型",dataIndex:"type",width:600},{title:"规则名称",slotName:"ruleName",width:300},{title:"运行次数",dataIndex:"query",width:100},{title:"命中次数",dataIndex:"hit",filterable:{filter:(_,u)=>_[0]==="yes"&&u.hit>0,slotName:"hit-filter"}}];return k(()=>o.endpoint,r),(_,u)=>{const x=P,d=z,T=E,w=L,S=j;return f(),B(S,{columns:g,data:m(c),size:"large",loading:m(p),"column-resizable":"","filter-icon-align-left":"",pagination:{showPageSize:!0}},{empty:e(()=>[t(x)]),ruleName:e(({record:n})=>[t(d,{code:""},{default:e(()=>[s(C(n.metadata.rule),1)]),_:2},1024)]),"hit-filter":e(({filterValue:n,handleFilterConfirm:b,handleFilterReset:v})=>[R("div",Q,[t(w,null,{default:e(()=>[t(T,{modelValue:n[0],"onUpdate:modelValue":i=>n[0]=i,"checked-value":"yes","unchecked-value":"no",onChange:i=>i==="yes"?b():v()},null,8,["modelValue","onUpdate:modelValue","onChange"]),t(d,null,{default:e(()=>[s("仅显示命中过的规则")]),_:1})]),_:2},1024)])]),_:1},8,["data","loading"])}}}),G=M($,[["__scopeId","data-v-6b308082"]]),X=y({__name:"RuleMetrics",setup(l){return(a,o)=>{const c=F,r=J,p=D;return f(),q(A,null,[t(p,null,{default:e(()=>[t(c,{heading:3},{default:e(()=>[s("规则统计")]),_:1}),t(r,null,{default:e(()=>[s(" 以下是规则统计信息，你可以通过规则命中次数（封禁次数）和运行次数来评估规则的有效性。 ")]),_:1})]),_:1}),t(G)],64)}}});export{X as default};
